<?xml version='1.0'?>

<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <?include ../fig.wxi?>

    <Product
        Id="*"
        Language='1033'
        Manufacturer="Fig"
        Name="Figterm"
        UpgradeCode="BF736EB5-9203-46BB-884D-14BF2F26279C"
        Version="$(var.Version)"
    >
        <Package
            Compressed="yes"
            Description="Figterm works in the shells you do, only providing the minimum info needed to the Fig api"
            Id="*"
            InstallerVersion="450"
            InstallPrivileges="limited"
            InstallScope="perUser"
            Manufacturer="Fig"
        />

        <MajorUpgrade DowngradeErrorMessage="A later version of [ProductName] is already installed. Setup will now exit"/>

        <Media Id='1' Cabinet='media1.cab' EmbedCab='yes' DiskPrompt='CD-ROM #1'/>
        <Property Id='DiskPrompt' Value='Figterm Installation'/>

        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="LocalAppDataFolder">
                <Directory Id="FIGROOT" Name="Fig">
                    <Component Guid="98B128BB-5886-43DA-9F68-AE087F270DCD" Id="InstallFigterm">
                        <RegistryValue
                            Key="Software\Fig\Figterm"
                            KeyPath="yes"
                            Name="InstallFolder"
                            Root="HKCU"
                            Type="string"
                            Value="[INSTALLFOLDER]"
                        />
                        <File
                            Name="figterm.exe"
                            Source="target/release/figterm.exe"
                        />
                        <RemoveFolder
                            Id="RemoveINSTALLFOLDER"
                            On="uninstall"
                        />
                        <RemoveFolder
                            Id="RemoveFIGROOT"
                            Directory="FIGROOT"
                            On="uninstall"
                        />
                    </Component>
                </Directory>
            </Directory>
        </Directory>

        <Feature Id="Install">
            <ComponentRef Id="InstallFigterm"/>
        </Feature>
    </Product>
</Wix>
